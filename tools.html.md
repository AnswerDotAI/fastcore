# LLM tools


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Bash Tools

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L14"
target="_blank" style="float:right; font-size:smaller">source</a>

### run_cmd

>  run_cmd (cmd:str, argstr:str='', disallow_re:str=None, allow_re:str=None)

*Run `cmd` passing split `argstr`, optionally checking for allowed
argstr*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>cmd</td>
<td>str</td>
<td></td>
<td>The command name to run</td>
</tr>
<tr>
<td>argstr</td>
<td>str</td>
<td></td>
<td>All args to the command, will be split with shlex</td>
</tr>
<tr>
<td>disallow_re</td>
<td>str</td>
<td>None</td>
<td>optional regex which, if matched on argstr, will disallow the
command</td>
</tr>
<tr>
<td>allow_re</td>
<td>str</td>
<td>None</td>
<td>optional regex which, if not matched on argstr, will disallow the
command</td>
</tr>
</tbody>
</table>

With this little function, we can now run any cli command:

``` python
print(run_cmd('ls')[:128])
```

    000_tour.ipynb
    00_test.ipynb
    01_basics.ipynb
    02_foundation.ipynb
    03_xtras.ipynb
    03a_parallel.ipynb
    03b_net.ipynb
    04_docments.ipy

Note that, for tool safety, this is not passed through the shell, so
wildcards, env vars, etc will not work:

``` python
print(run_cmd('ls', 'f*')[:128])
```

    ls: f*: No such file or directory

Let’s create some useful functions from this that will allow for
searching, reading and modifing content on the file system.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L30"
target="_blank" style="float:right; font-size:smaller">source</a>

### rg

>  rg (argstr:str, disallow_re:str=None, allow_re:str=None)

*Run the [`rg`](https://fastcore.fast.ai/tools.html#rg) command with the
args in `argstr` (no need to backslash escape)*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>argstr</td>
<td>str</td>
<td></td>
<td>All args to the command, will be split with shlex</td>
</tr>
<tr>
<td>disallow_re</td>
<td>str</td>
<td>None</td>
<td>optional regex which, if matched on argstr, will disallow the
command</td>
</tr>
<tr>
<td>allow_re</td>
<td>str</td>
<td>None</td>
<td>optional regex which, if not matched on argstr, will disallow the
command</td>
</tr>
</tbody>
</table>

``` python
rg('fast.ai CNAME')
```

    '1:fastcore.fast.ai\n'

Functions implemented with
[`run_cmd`](https://fastcore.fast.ai/tools.html#run_cmd) like this one
can be passed regexps to allow or disallow arg strs, i.e to block parent
or root directories:

``` python
disallowed = r' /|\.\.'
rg('info@fast.ai ..', disallow_re=disallowed)
```

    'Error: args disallowed'

``` python
rg('info@fast.ai /', disallow_re=disallowed)
```

    'Error: args disallowed'

``` python
print(rg('fast.ai CNAME', disallow_re=disallowed))
```

    1:fastcore.fast.ai

NB: These tools have special behavior around errors. Since these have
been speficially designed for work with LLMs, any exceptions created
from there use is returned as a string to help them debug their work.

``` python
run_cmd('asdfe')
```

    "Error running cmd: [Errno 2] No such file or directory: 'asdfe'"

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L39"
target="_blank" style="float:right; font-size:smaller">source</a>

### sed

>  sed (argstr:str, disallow_re:str=None, allow_re:str=None)

*Run the [`sed`](https://fastcore.fast.ai/tools.html#sed) command with
the args in `argstr` (e.g for reading a section of a file)*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>argstr</td>
<td>str</td>
<td></td>
<td>All args to the command, will be split with shlex</td>
</tr>
<tr>
<td>disallow_re</td>
<td>str</td>
<td>None</td>
<td>optional regex which, if matched on argstr, will disallow the
command</td>
</tr>
<tr>
<td>allow_re</td>
<td>str</td>
<td>None</td>
<td>optional regex which, if not matched on argstr, will disallow the
command</td>
</tr>
</tbody>
</table>

``` python
print(sed('-n "1,5 p" _quarto.yml'))
```

    project:
      type: website
      pre-render: 
        - pysym2md --output_file apilist.txt fastcore
      post-render: 

``` python
# Print line numbers too
print(sed('-n "1,5 {=;p;}" _quarto.yml'))
```

    1
    project:
    2
      type: website
    3
      pre-render: 
    4
        - pysym2md --output_file apilist.txt fastcore
    5
      post-render: 

## Text Edit Tools

Python implementations of the text editor tools from
[Anthropic](https://docs.claude.com/en/docs/agents-and-tools/tool-use/text-editor-tool).
These tools are especially useful in an AI’s tool loop. See
[`claudette`](https://claudette.answer.ai/text_editor.html) for
examples.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L48"
target="_blank" style="float:right; font-size:smaller">source</a>

### view

>  view (path:str, view_range:tuple[int,int]=None, nums:bool=False)

*View directory or file contents with optional line range and numbers*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td></td>
<td>Path to directory or file to view</td>
</tr>
<tr>
<td>view_range</td>
<td>tuple</td>
<td>None</td>
<td>Optional 1-indexed (start, end) line range for files, end=-1 for
EOF</td>
</tr>
<tr>
<td>nums</td>
<td>bool</td>
<td>False</td>
<td>Whether to show line numbers</td>
</tr>
</tbody>
</table>

You can specify line ranges and whether to have the output contain line
numbers:

``` python
print(view('_quarto.yml', (1,10), nums=True))
```

         1 │ project:
         2 │   type: website
         3 │   pre-render: 
         4 │     - pysym2md --output_file apilist.txt fastcore
         5 │   post-render: 
         6 │     - llms_txt2ctx llms.txt --optional true --save_nbdev_fname llms-ctx-full.txt
         7 │     - llms_txt2ctx llms.txt --save_nbdev_fname llms-ctx.txt
         8 │   resources: 
         9 │     - "*.txt"
        10 │   preview:

Here’s what the output looks like when viewing a directory:

``` python
print(view('.', (1,5)))
```

    Directory contents of /Users/jhoward/aai-ws/fastcore/nbs:
    /Users/jhoward/aai-ws/fastcore/nbs/llms.txt
    /Users/jhoward/aai-ws/fastcore/nbs/000_tour.ipynb
    /Users/jhoward/aai-ws/fastcore/nbs/parallel_test.py
    /Users/jhoward/aai-ws/fastcore/nbs/_quarto.yml
    /Users/jhoward/aai-ws/fastcore/nbs/08_style.ipynb

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L76"
target="_blank" style="float:right; font-size:smaller">source</a>

### create

>  create (path:str, file_text:str, overwrite:bool=False)

*Creates a new file with the given content at the specified path*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td></td>
<td>Path where the new file should be created</td>
</tr>
<tr>
<td>file_text</td>
<td>str</td>
<td></td>
<td>Content to write to the file</td>
</tr>
<tr>
<td>overwrite</td>
<td>bool</td>
<td>False</td>
<td>Whether to overwrite existing files</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

``` python
print(create('test.txt', 'Hello, world!'))
f = Path('test.txt')
test_eq(f.exists(), True)
print('Contents:\n', view(f, nums=True))
```

    Created file test.txt.
    Contents:
          1 │ Hello, world!

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L92"
target="_blank" style="float:right; font-size:smaller">source</a>

### insert

>  insert (path:str, insert_line:int, new_str:str)

*Insert new_str at specified line number*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>Path to the file to modify</td>
</tr>
<tr>
<td>insert_line</td>
<td>int</td>
<td>Line number where to insert (0-based indexing)</td>
</tr>
<tr>
<td>new_str</td>
<td>str</td>
<td>Text to insert at the specified line</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td></td>
</tr>
</tbody>
</table>

``` python
insert(f, 0, 'Let\'s add a new line')
print(view(f, nums=True))
```

         1 │ Let's add a new line
         2 │ Hello, world!

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L110"
target="_blank" style="float:right; font-size:smaller">source</a>

### str_replace

>  str_replace (path:str, old_str:str, new_str:str)

*Replace first occurrence of old_str with new_str in file*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>Path to the file to modify</td>
</tr>
<tr>
<td>old_str</td>
<td>str</td>
<td>Text to find and replace</td>
</tr>
<tr>
<td>new_str</td>
<td>str</td>
<td>Text to replace with</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td></td>
</tr>
</tbody>
</table>

``` python
str_replace(f, 'new line', '')
print(view(f, nums=True))
```

         1 │ Let's add a 
         2 │ Hello, world!

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L129"
target="_blank" style="float:right; font-size:smaller">source</a>

### strs_replace

>  strs_replace (path:str, old_strs:list[str], new_strs:list[str])

*Replace for each str pair in old_strs,new_strs*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>Path to the file to modify</td>
</tr>
<tr>
<td>old_strs</td>
<td>list</td>
<td>List of strings to find and replace</td>
</tr>
<tr>
<td>new_strs</td>
<td>list</td>
<td>List of replacement strings (must match length of old_strs)</td>
</tr>
</tbody>
</table>

``` python
strs_replace(f, ["add a new line", "world!"], ["just say", "friends!\nNice to see you."])
print(view(f, nums=True))
```

         1 │ Let's add a 
         2 │ Hello, friends!
         3 │ Nice to see you.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fastcore/blob/main/fastcore/tools.py#L139"
target="_blank" style="float:right; font-size:smaller">source</a>

### replace_lines

>  replace_lines (path:str, start_line:int, end_line:int, new_content:str)

*Replace lines in file using start and end line-numbers (index starting
at 1)*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>str</td>
<td>Path to the file to modify</td>
</tr>
<tr>
<td>start_line</td>
<td>int</td>
<td>Starting line number to replace (1-based indexing)</td>
</tr>
<tr>
<td>end_line</td>
<td>int</td>
<td>Ending line number to replace (1-based indexing, inclusive)</td>
</tr>
<tr>
<td>new_content</td>
<td>str</td>
<td>New content to replace the specified lines</td>
</tr>
</tbody>
</table>

``` python
replace_lines('test.txt', 1, 2, 'Replaced first two lines')
print(view('test.txt', nums=True))
```

         1 │ Replaced first two lines
         2 │ Nice to see you.

``` python
f.unlink()
```
